{% load attachments_tags_custom %}
<script type="text/javascript" charset="utf-8">

function bindPostAttachmentHandler(fid) {
    $('#attachment_form_' + fid).submit(function f() {
        this_form = $(this);
        $.ajax({
            type: "POST",
            data: this_form.serialize(),
            url: this_form.attr('action'),
            cache: false,
            dataType: "html",
            success: function(html, textStatus) {
                var attachment = this_form[0].attachment_file;
                if (attachment.value != '') {
                    this_form.replaceWith(html);
                }
                else {
                    alert('else');
                    this_form.replaceWith(html);
                }
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                this_form.replaceWith('Your attachment was unable to be uploaded at this time.  We apologise for the inconvenience.');
            }
        });
        return false;
    });
}

function deleteCommentHandler(cid) {
    var agree = confirm("Do you want to delete this comment?");
    
    if (agree){
        $('#delete_form_' + cid).submit(function fd() {
            this_form = $(this);
            this_url = this_form.attr('action');
            comment = this_form.parent();
            $.ajax({
                type: "POST",
                data: this_form.serialize(),
                url: this_url,
                cache: false,
                dataType: "html",
                success: function(html, textStatus) {
                    comment.parent().replaceWith('');
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    alert(errorThrown);
                }
            });
            return false;
        });
    }
    else
        return false;
}

</script>